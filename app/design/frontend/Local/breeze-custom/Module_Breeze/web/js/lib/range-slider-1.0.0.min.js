class RangeSlider extends HTMLElement{connectedCallback(){this.addMarkup(),this.addEventListener("touchstart",this.onMouseDown.bind(this),{passive:!0}),this.addEventListener("mousedown",this.onMouseDown.bind(this)),this.addEventListener("touchend",this.onMouseUp.bind(this)),this.addEventListener("mouseup",this.onMouseUp.bind(this)),this.addEventListener("input",this.onInput.bind(this))}get value(){return[this.min.valueAsNumber,this.max.valueAsNumber].sort(((t,e)=>t-e))}set value(t){this.min.value=Math.min(...t),this.max.value=Math.max(...t)}addMarkup(){this.querySelector(":nth-child(1)")||this.insertAdjacentHTML("afterbegin",['<input class="range" type="range"/>','<input class="range" type="range"/>','<input class="filler" disabled type="range"/>'].join("")),this.initMinMaxElements();let t={step:this.getAttribute("step")||1,min:this.getAttribute("min")||0,max:this.getAttribute("max")||100};for(let[e,i]of Object.entries(t))this.min[e]=i,this.max[e]=i;let e=(this.getAttribute("value")||"").split("-").filter((t=>t));e.length?(this.min.value=e[0],this.max.value=e[1]||this.max.max):(this.min.value=this.min.min,this.max.value=this.max.max)}initMinMaxElements(){this.min=this.querySelector(":nth-child(1)"),this.max=this.querySelector(":nth-child(2)");let t=this.getAttribute("name");t&&(this.min.name=t+"[min]",this.max.name=t+"[max]")}onMouseDown(){this.constraint=this.max.valueAsNumber-this.min.valueAsNumber>5*Math.min(this.min.step,1)}onMouseUp(){this.constraint||(this.constraint=!0,this.min.valueAsNumber<this.max.valueAsNumber||(this.insertBefore(this.max,this.min),this.initMinMaxElements()))}onInput(t){if(this.constraint){let e=t.target;e===this.min?e.valueAsNumber>this.max.valueAsNumber&&(e.value=this.max.value):e.valueAsNumber<this.min.valueAsNumber&&(e.value=this.min.value)}this.dispatchEvent(new Event("range:input",{bubbles:!0}))}disconnectedCallback(){this.removeEventListener("touchstart",this.onMouseDown),this.removeEventListener("mousedown",this.onMouseDown),this.removeEventListener("touchend",this.onMouseUp),this.removeEventListener("mouseup",this.onMouseUp),this.removeEventListener("input",this.onInput)}}customElements.define("range-slider",RangeSlider);
